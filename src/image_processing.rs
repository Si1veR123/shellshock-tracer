use crate::bitmap::{Bitmap, ARGB};

const TANK_HEIGHT_FRACTION: f32 = 0.0185185;
const TANK_WIDTH_FRACTION: f32 = 0.0208333;
const MENU_BAR: f32 = 0.17037037;

fn tank_size_for_dimensions(dimensions: (u32, u32)) -> (u32, u32) {
    let width = dimensions.0 as f32 * TANK_WIDTH_FRACTION;
    let height = dimensions.1 as f32 * TANK_HEIGHT_FRACTION;

    (width as u32, height as u32)
}

fn pixel_score(pixel: ARGB) -> f32 {
    let r = pixel.r as f32;
    let g = pixel.g as f32;
    let b = pixel.b as f32;

    g - r - b
}

// relative to bottom left
pub fn find_tank(bitmap: &Bitmap<ARGB>, dimensions: (u32, u32)) -> Option<(u32, u32)> {
    let tank_size = tank_size_for_dimensions(dimensions);
    let menu_size_pixels = (dimensions.1 as f32 * MENU_BAR) as u32;
 
    let mut scores: Vec<f32> = Vec::with_capacity(bitmap.inner.len());
    for pixel in bitmap.inner.iter() {
        scores.push(pixel_score(*pixel))
    }
    let score_bitmap = Bitmap::new(scores.as_mut_slice(), bitmap.width);

    let mut buffer: Vec<f32> = Vec::with_capacity((tank_size.0*tank_size.1) as usize);
    let mut most_likely_rect = (f32::MIN, None);

    for x in 0..(dimensions.0 - tank_size.0) {
        for y in menu_size_pixels..(dimensions.1 - tank_size.1) {
            score_bitmap.subrect(&mut buffer, x, y, tank_size.0, tank_size.1);
            let score = buffer.iter().sum();

            if score > most_likely_rect.0 {
                most_likely_rect = (score, Some((x, y)))
            }
        }
    }

    most_likely_rect.1
}


#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn tank_bitmap_test() {
        // a screenshot of a green tank (TODO: open from file instead)
        let tank_raw_bitmap = [1658951, 1527622, 1593415, 1593671, 1593670, 1659718, 1725254, 1659461, 1659461, 1725510, 1791302, 1791302, 1988424, 1857349, 2054472, 2054728, 2121032, 2451018, 966686, 1368866, 831518, 956962, 2187338, 2121544, 2055752, 2121032, 2055496, 1989703, 1989704, 1923911, 1858118, 1858374, 1858119, 1792326, 1857607, 1726022, 1726022, 1726023, 1791303, 1791303, 1791303, 1791048, 1725255, 1790535, 1659462, 1527876, 1593413, 1593413, 1527877, 1527878, 1527621, 1527622, 1527366, 1593159, 1527622, 1593415, 1593671, 1593926, 1659462, 1659461, 1724998, 1791302, 1725509, 1791302, 1857095, 1988425, 1923398, 1988935, 2120521, 2252362, 2384460, 1899563, 3276090, 1346085, 1725996, 2318666, 2187592, 2187592, 2121800, 2187593, 2253130, 2187593, 2121801, 2187081, 2055753, 1989960, 1923912, 1988936, 1923144, 1792071, 1923144, 1922888, 1857095, 1857097, 1856840, 1791048, 1856585, 1856585, 1593670, 1593670, 1593670, 1593414, 1527877, 1593670, 1461829, 1527623, 1593415, 1593671, 1527879, 1659463, 1593670, 1659462, 1659718, 1725511, 1725766, 1857095, 1857351, 1857351, 1988679, 1988679, 2054984, 2055239, 2187081, 2318922, 1871159, 10091933, 8322435, 1027104, 2060349, 2320711, 2255174, 2321222, 2320967, 2386504, 2320711, 2320712, 2254664, 2188104, 2121801, 2055752, 1989448, 2055241, 1923656, 1988680, 1989193, 1923145, 1922633, 1922376, 1922633, 1856841, 1725768, 1790792, 1659463, 1593670, 1659463, 1593670, 1593671, 1527878, 1593671, 1593672, 1659464, 1593671, 1659464, 1725256, 1659718, 1725767, 1725510, 1791560, 1857095, 1922888, 1988679, 2054728, 1989447, 2121033, 2121289, 2187080, 2318923, 2256710, 1963049, 4324424, 3210553, 3013942, 3145273, 3865923, 4128070, 4062534, 5700957, 5307480, 4849234, 4914515, 5373273, 771104, 2121801, 2121545, 2121290, 2055241, 2054730, 2054730, 2054475, 1988681, 1988426, 1922633, 1857354, 1791305, 1725255, 1725256, 1659463, 1659464, 1593671, 1593671, 1593414, 1593671, 1593670, 1593927, 1593926, 1659719, 1659974, 1725511, 1791303, 1791559, 1791559, 1923144, 1923143, 1989192, 2055241, 2121032, 2186825, 2187081, 2252873, 2319178, 2125120, 1301538, 1234977, 965919, 1033760, 1032736, 1169185, 1234466, 2489904, 2686258, 1896233, 1498661, 2161452, 1831464, 2751796, 1480497, 2253130, 2187339, 2121290, 2186827, 2120777, 2054729, 2120265, 2054729, 1988681, 1922889, 1856840, 1791048, 1791047, 1659718, 1593670, 1659464, 1593671, 1659463, 1593415, 1593927, 1659463, 1725256, 1659719, 1725511, 1659974, 1726023, 1857352, 1857608, 1988936, 2120777, 2121289, 2252874, 2253130, 2318922, 2450251, 2516299, 2450504, 1352742, 1288740, 1354533, 1288484, 1288996, 1354789, 1291556, 1291811, 1358884, 1358373, 1422885, 1488166, 1486887, 1290789, 1230371, 965665, 2256454, 2450764, 2384716, 2449996, 2383948, 2383948, 2252362, 2186570, 2054473, 1923145, 1856840, 1791048, 1791304, 1725511, 1724999, 1593927, 1659463, 1659464, 1593672, 1659720, 1593927, 1725256, 1659975, 1725768, 1791816, 1726023, 1857608, 1923657, 2055241, 2119744, 2119737, 2251578, 2383419, 2514748, 2514748, 2515259, 2322741, 1872940, 1872683, 1809707, 1679401, 1742635, 1805867, 1806892, 1808427, 1875500, 1939501, 2004526, 2070575, 1940270, 1874732, 1745451, 1808940, 2256949, 2515261, 2514749, 2514494, 2514237, 2382652, 2316603, 2184765, 2186314, 2054730, 1988426, 1856840, 1791304, 1791304, 1659719, 1725256, 1659720, 1593671, 1593928, 1659720, 1659720, 1725513, 1725768, 1791561, 1791816, 1857352, 1857608, 1989449, 2187338, 1027364, 8781193, 7929469, 7994750, 7601272, 8519045, 8650375, 8781193, 9502101, 9633174, 8387972, 6552937, 7011439, 5569883, 6094178, 7667065, 9698967, 9632918, 9502100, 8256642, 8387972, 9764248, 8584839, 7601529, 7798139, 8322435, 9567382, 8519046, 8322435, 8715657, 8322691, 7732604, 2383948, 2120267, 1922888, 1922889, 1791304, 1791304, 1791304, 1725256, 1725256, 1725257, 1659464, 1725514, 1725513, 1725769, 1791560, 1791817, 1857353, 1923401, 1923400, 2121291, 2054206, 7666810, 2948151, 3472702, 3341628, 2817077, 3079480, 2423600, 3210554, 5832030, 5111380, 2489136, 1761576, 2751796, 4193864, 2292270, 3210554, 2158893, 3013944, 3145273, 4848977, 4390218, 4193608, 3931204, 2882870, 3079481, 3013944, 3931716, 4586830, 3800387, 3079481, 4717648, 7208563, 2119738, 2186571, 1988937, 1923145, 1922889, 1791561, 1725768, 1725256, 1791049, 1725257, 1725257, 1725769, 1726025, 1857354, 1857353, 1857353, 1923145, 1989449, 2054986, 2121290, 1345067, 4128071, 1433126, 1497894, 2027564, 1961259, 1961259, 1960491, 1959723, 1693736, 1626407, 1894954, 1489703, 1629991, 1359142, 1357861, 1629735, 1560871, 1558311, 1760297, 2158125, 2817333, 3341628, 2290991, 1692201, 1693993, 1695785, 1629224, 1493032, 1491240, 1494055, 1228581, 1366822, 831779, 2252365, 2054731, 1989195, 1922890, 1922890, 1922890, 1791561, 1791306, 1725512, 1725257, 1726026, 1857354, 1791817, 1923146, 1988939, 1989194, 2054986, 2055241, 2121287, 1237795, 969505, 965922, 1159973, 1098531, 1432358, 1297956, 1295909, 1231140, 1363493, 1292069, 1225764, 1290021, 1224485, 1354278, 1289765, 1288998, 1226533, 1162276, 1357862, 1423400, 1359142, 1762857, 1697321, 1364518, 1294374, 1226534, 1161766, 1289255, 1223974, 1094437, 1092901, 1026085, 3800387, 2055236, 2054986, 2120523, 1988682, 1988682, 1922890, 1922890, 1791305, 1791306, 1791306, 1791307, 1857355, 1923148, 1923403, 2054731, 2120523, 2120523, 2186827, 2055233, 1568551, 832290, 898594, 964130, 898850, 1033251, 1100579, 1233444, 965410, 1160740, 1223461, 1286438, 1221413, 1286695, 1285671, 1285671, 1286696, 1157414, 1094180, 1223974, 1159717, 1224742, 1226022, 1160230, 1096741, 1158950, 1028389, 1092390, 1026341, 1092390, 1154855, 1090087, 1088807, 893733, 1988927, 2186573, 2120780, 2054732, 2054476, 1923147, 1922891, 1857355, 1857099, 1791307, 1857612, 1923148, 1988940, 1988939, 2054475, 2251339, 2185545, 2251081, 2250822, 1155368, 962084, 1027364, 1157670, 1091876, 1158949, 1158181, 1222694, 1222950, 1286439, 1222950, 1286439, 1415466, 1414953, 1349417, 1349161, 1479466, 1348905, 1286696, 1286696, 1289255, 1223207, 1288744, 1287720, 1287209, 1351209, 1286697, 1351210, 1221672, 1220136, 1219369, 1153832, 1088551, 1090088, 2315846, 2185288, 2251339, 2185802, 2120011, 2054220, 1988940, 1857611, 1857100, 1791307, 1923405, 1923404, 2186318, 2251853, 2186566, 2120762, 2120249, 2185272, 2184504, 2249784, 1865521, 1482795, 1482539, 1547819, 1482794, 1613611, 1613868, 1547819, 1613356, 1613099, 1547563, 1611308, 1676333, 1740846, 1805871, 1805614, 1742638, 1613100, 1679149, 1613356, 1614380, 1614893, 1549100, 1548588, 1613613, 1484587, 1548332, 1612845, 1482028, 1547308, 1547564, 1803057, 2249273, 2315579, 2250554, 2119993, 2251073, 2251847, 2251596, 2186061, 2054734, 1922892, 1922637, 1989198, 2120782, 2318160, 1991736, 2058549, 1808688, 1744175, 1874224, 2003762, 2068019, 2132531, 2387767, 2132531, 2133043, 2199348, 2133811, 2134578, 2134067, 2198579, 2133555, 2133811, 2198324, 2263348, 2328373, 2327605, 2263605, 2328885, 2264884, 2265652, 2200372, 2200116, 2199861, 2134323, 2199349, 2200373, 2134836, 2198836, 2199349, 2199605, 2134068, 2390840, 2516538, 2133300, 2003506, 1939506, 1875761, 1743920, 1994549, 2057272, 2186572, 2120782, 2054478, 1922893, 2054989, 2252624, 1795894, 1357611, 13369039, 12189117, 9305491, 9239953, 9043599, 9108880, 8846476, 9240209, 9567639, 9502101, 9174417, 9305490, 9895323, 10026141, 8584584, 8519047, 8387716, 8715658, 8912268, 9305491, 10026141, 9698712, 9895323, 9567638, 9764249, 9633175, 9895323, 9829787, 9633176, 9239954, 9174417, 9174161, 9371028, 9305235, 9567639, 9895580, 9371027, 9502102, 9436565, 9108880, 9305491, 9370772, 11009709, 13172172, 2026544, 1798197, 2187084, 2120527, 1923150, 2121038, 1927227, 7208310, 8256901, 7470457, 6487403, 6749551, 6946417, 6290791, 6159718, 6552939, 7273846, 7143027, 7208052, 6946161, 7732347, 6815343, 5963106, 5832032, 6028899, 5700958, 5963362, 6028643, 6552938, 7404919, 7863933, 7732860, 7601530, 7404663, 7011441, 7011697, 7536249, 7667067, 6487402, 6487658, 6225254, 6356329, 6552939, 6880624, 7535993, 6749294, 7208309, 6880368, 7208564, 7077234, 6946161, 6618476, 6618476, 7535994, 8978063, 1666614, 2186832, 2055248, 1925976, 1897266, 7470714, 6684014, 2555193, 2202430, 2781776, 2846544, 2781007, 2781007, 2846801, 2781518, 2781518, 2781263, 2847055, 2781519, 2781518, 2781774, 2781518, 2781774, 2781774, 2781774, 2781774, 2913360, 3110996, 3176788, 2912848, 2847311, 2913104, 2912848, 2847312, 2847056, 2847312, 2847312, 2781775, 2847312, 2913105, 2847312, 2912592, 2912593, 2846800, 2846800, 2780752, 2846544, 2846545, 2781520, 2395971, 1961523, 6093926, 6552941, 3603780, 2187596, 2121040, 1733224, 7142518, 5963109, 2161719, 2649169, 2647891, 2647380, 2515794, 2581587, 2516049, 2516048, 2581841, 2516304, 2516048, 2582098, 2516049, 2516304, 2516560, 2516303, 2451024, 2516560, 2516303, 2582097, 2516561, 2779733, 2845526, 2713940, 2582097, 2647633, 2647891, 2582353, 2713427, 2582097, 2582354, 2582098, 2582097, 2582098, 2516305, 2581842, 2581586, 2581585, 2581586, 2515795, 2581587, 2581330, 2515794, 2581586, 2647891, 1293616, 5111129, 5963365, 1928006, 2121297, 1734228, 6093929, 4390225, 2518864, 2516819, 2384978, 2318930, 2318673, 2318929, 2253392, 2319186, 2319184, 2187855, 2319184, 2253648, 2253648, 2319184, 2253648, 2319440, 2253648, 2187855, 2253647, 2253648, 2319185, 2385490, 2451538, 2319696, 2319184, 2253647, 2253904, 2319440, 2319184, 2253391, 2253648, 2319442, 2319442, 2319185, 2384978, 2318929, 2253136, 2384466, 2318929, 2318673, 2252881, 2318674, 2318930, 2318930, 2385236, 2451027, 3538245, 4259150, 1347383, 2187603, 1672269, 4652117, 3603784, 2191435, 2385492, 2319700, 2253395, 2187859, 2253652, 2187859, 2188114, 2188114, 2253906, 2188113, 2188113, 2188114, 2188113, 2122320, 2188113, 2122577, 2188113, 2253906, 2188114, 2188113, 2188371, 2254162, 2319699, 2254161, 2254162, 2253906, 2253649, 2253906, 2253906, 2253650, 2253650, 2253907, 2253650, 2253907, 2253907, 2319188, 2187858, 2187602, 2318932, 2253139, 2253139, 2253395, 2253395, 2253651, 1929800, 2030645, 3079488, 1027636, 2188117, 1688709, 4521558, 2489660, 1346359, 2279873, 2148291, 2149060, 2214597, 2148804, 2149061, 2083265, 2148289, 2082753, 2082495, 2016701, 2082750, 2082493, 2017214, 2082751, 2017214, 2017214, 2082751, 2017214, 2017214, 2083007, 2017214, 2082750, 2148543, 2082750, 2016958, 2016958, 2017471, 2083267, 2083524, 2149317, 2083524, 2017730, 2083009, 2083011, 2082754, 2082496, 2147519, 2147263, 2147007, 2147006, 2147265, 2147778, 2148036, 1092155, 972078, 2686526, 969802, 2213059, 2083758, 3472713, 3603786, 1154101, 1284927, 2150343, 2150604, 2085070, 2150863, 2216656, 2150861, 2151118, 2150862, 2151118, 2151118, 2085580, 2151119, 2151631, 2151632, 2085840, 2085839, 2020302, 1955020, 2086095, 2020301, 2020042, 2086094, 2020300, 2085835, 2151372, 2151117, 2085324, 2151374, 2085324, 2085323, 2150604, 2151118, 2019789, 2085326, 2085326, 2150348, 2084554, 2149580, 2018507, 2149835, 2084043, 2084043, 1026374, 956722, 972847, 2227515, 1691038, 2280909, 2412747, 3079494, 3407176, 1090868, 1022516, 1022262, 1087805, 1087805, 1022269, 1087037, 1087550, 1084478, 1084733, 1084988, 1085756, 956987, 1085500, 1149246, 1148222, 1211966, 1214270, 1277503, 1147710, 1212478, 1148733, 1085244, 1086268, 1020731, 1084988, 1215293, 1214781, 1150780, 1086268, 1150525, 1148989, 1279039, 1214527, 1214782, 1150527, 1086525, 1150270, 956731, 1022524, 1022523, 1022523, 1022268, 953909, 889395, 761905, 1304626, 1899321, 2083765, 2279883, 2345928, 1555566, 2882882, 1237298, 891955, 1018165, 889650, 823090, 888626, 887090, 756784, 886834, 821041, 822576, 694830, 694830, 693806, 820527, 885297, 884785, 755758, 820784, 820016, 884529, 756015, 884784, 886320, 949809, 820783, 758318, 693293, 692014, 757807, 822832, 757039, 886065, 821808, 756016, 821553, 757808, 823345, 756528, 950835, 886578, 758321, 822065, 821810, 823859, 440365, 973105, 1160532, 2278852, 2213318, 2345413, 2410178, 1226314, 1237555, 973615, 505901, 568622, 503340, 438315, 438315, 372778, 373802, 373033, 307240, 372521, 436009, 434474, 370729, 434730, 499755, 498986, 433962, 433706, 498987, 369960, 372519, 370983, 437288, 370984, 436265, 437289, 437289, 308519, 373543, 438312, 437802, 435755, 371497, 500524, 370218, 434731, 436267, 501292, 499756, 501548, 500781, 502573, 440365, 440366, 832318, 2079673, 2345416, 2280138, 2411465, 2342074, 2205861, 1546080, 572720, 1040942, 909101, 1106990, 909100, 1174318, 1041452, 1636145, 1240621, 1041963, 1041707, 578600, 309031, 308775, 309031, 241702, 372776, 307495, 241958, 372520, 308774, 644904, 644648, 378663, 313126, 312358, 312102, 511782, 578599, 1240620, 1042218, 710953, 710953, 379176, 309032, 308777, 310824, 375081, 307753, 308777, 438571, 372779, 439597, 438830, 1217875, 1941919, 2210234, 2279370, 2280398, 2344904, 2272941, 2069136, 1999744, 1932148, 1473879, 1408078, 1342539, 1276745, 1342282, 1211464, 1211463, 1211720, 1145670, 1145414, 1210437, 1209413, 1209157, 1209413, 1144388, 1209670, 1208901, 1208900, 1209157, 1209413, 1144388, 1144132, 1143876, 1144388, 1144132, 1144644, 1275461, 1210180, 1209924, 1144644, 1209669, 1210181, 1143621, 1144389, 1209927, 1210183, 1274952, 1274952, 1275209, 1406540, 1340748, 1406290, 1668461, 1866618, 1870215, 2073507, 2211520, 2279112];
        let tank_bitmap: [ARGB; 1484] = unsafe { std::mem::transmute(tank_raw_bitmap) };

        let score: f32 = tank_bitmap.iter().map(|pixel| pixel_score(*pixel)).sum();

        println!("{score}");
    }

    #[test]
    fn bad_image_test() {
        // random bad image
        let img_raw_bitmap = [4079166, 4144959, 4144959, 4144959, 4079166, 4144959, 4079166, 4144959, 4079166, 4144959, 4144959, 4079166, 4144959, 4079166, 4144959, 4144959, 4144959, 4144959, 4079166, 4079166, 4079166, 4013373, 4144959, 4079166, 4079166, 4013374, 3947580, 4013373, 4079165, 4079165, 4079165, 4144957, 4079165, 4079164, 4013373, 3947580, 4013373, 3947580, 4013373, 4013372, 4473924, 9013641, 16645629, 16777215, 16777215, 16777215, 16777215, 16250871, 8947848, 6513507, 9211020, 9539985, 7697781, 4144959, 4144959, 4079166, 4079166, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4079166, 4144959, 4144959, 4144959, 4079166, 4079166, 4013373, 4079166, 4013373, 3947581, 4013373, 4079165, 4144957, 4013372, 4079165, 4079164, 4013372, 4079165, 4013373, 4013373, 3947580, 4013373, 4013372, 4276544, 10790052, 16053492, 16777215, 16777215, 16777215, 16777215, 16448250, 9408399, 4276545, 3947580, 4013373, 4013373, 4079164, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4079166, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4079166, 4144959, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4013373, 4013373, 4079165, 4144957, 4013373, 4013373, 4013373, 4013373, 3947580, 4013373, 4605766, 13290186, 16645629, 16777215, 16777215, 16777215, 16777215, 16645629, 10461087, 4079166, 3947580, 4013373, 4013373, 4079164, 4079165, 4079166, 4144959, 4144959, 4144959, 4079166, 4144959, 4079166, 4144959, 4079166, 4144959, 4144959, 4079166, 4079166, 4144959, 4144959, 4079166, 4144959, 4144959, 4144959, 4144959, 4079166, 4013373, 4079166, 4079166, 4079166, 4013373, 4013373, 4079166, 4079166, 4079166, 4079165, 4079165, 4013373, 4079165, 4013373, 3947580, 4013373, 5987163, 12961221, 16711422, 16777215, 16777215, 16777215, 16777215, 16777215, 12434877, 5066061, 4013373, 4013373, 4013373, 3947580, 4013373, 4079166, 4144959, 4144959, 4079166, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4079166, 4144959, 4079167, 4079166, 4079166, 4013373, 3947580, 3947836, 4079166, 4079166, 4013373, 4079166, 4079166, 4013373, 4079166, 4079166, 4144959, 4013374, 6381921, 14737632, 16645629, 16777215, 16777215, 16777215, 16777215, 16777215, 13421772, 5131854, 3947580, 4013373, 4013373, 3947580, 4013373, 4079166, 4079166, 4144959, 4144959, 4144959, 4144703, 4144959, 4079166, 4144959, 4144959, 4079166, 4144959, 4144959, 4144959, 4144959, 4079166, 4144959, 4079166, 4144959, 4144959, 4144959, 4144959, 4079167, 4079167, 4079166, 4079166, 3947838, 4013373, 4013373, 4079165, 4079166, 4079166, 4079166, 4079166, 4079166, 4013629, 4079166, 4013373, 12698050, 16777215, 16777215, 16777215, 16777215, 16777215, 16711422, 14342874, 5197647, 4013373, 4013373, 3947580, 4013373, 4013373, 3947580, 4013374, 4079166, 4079166, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4079166, 4144959, 4144959, 4144957, 4144959, 4144959, 4079166, 4144959, 4144959, 4144959, 4079166, 4144959, 4079166, 4013629, 4144959, 4079166, 4079166, 4079165, 4079166, 4079166, 4013373, 4013373, 4013373, 4079166, 4079166, 4013373, 4079166, 12040120, 16777215, 16777215, 16777215, 16777215, 16777215, 15461355, 7039851, 4079166, 4013373, 3947580, 4013373, 4013373, 3947580, 4013373, 3947582, 4013373, 4144959, 4144959, 4144959, 4079166, 4144959, 4079166, 4144959, 4144959, 4144959, 4144959, 4079166, 4144958, 4144958, 4144957, 4144959, 4144959, 4144959, 4079166, 4144959, 4144958, 4079166, 4079166, 4079166, 4013373, 4013373, 4079166, 4013373, 4144957, 4079166, 4079166, 4079166, 4144959, 4079166, 4079166, 4079166, 4079166, 5263441, 15066597, 16777215, 16777215, 16777215, 16382457, 6908264, 4079166, 3947580, 4013373, 4013373, 4079166, 4013373, 4013373, 4013373, 4079166, 4079166, 4144959, 4079166, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4013631, 4144958, 4144701, 4079166, 4144958, 4079166, 4013629, 4079166, 4079166, 4013373, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079164, 4079165, 4079166, 4013373, 4079166, 4079166, 4013373, 4013373, 4079166, 4079166, 5789784, 13948116, 16645629, 15658734, 8882055, 4079166, 4079166, 4079166, 4079165, 3947580, 4013373, 3947581, 4013374, 4079166, 4079166, 4144959, 4144959, 4144959, 4144959, 4079166, 4144959, 4144959, 4079166, 4079166, 4144959, 4144959, 4079166, 4144957, 4079166, 4079166, 4013373, 4079166, 4013373, 4079166, 4144959, 4079166, 4013373, 4079166, 4013373, 4079166, 4079422, 4013373, 4079166, 4079165, 4079165, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4144959, 5723991, 7895160, 6842472, 4473924, 4013373, 4144959, 4079166, 4013373, 4079166, 4013374, 4013375, 4079166, 4079166, 4013373, 4013373, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4079166, 4079166, 4079166, 4013373, 4079166, 4079166, 4079166, 4079166, 4013373, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079165, 4013372, 4079164, 4079165, 4079165, 4013373, 4013629, 4079166, 4079166, 4013373, 4013373, 4079166, 4013373, 4079166, 4079166, 4079166, 4013373, 4079166, 4079166, 4079166, 4013374, 4013373, 4013373, 4079166, 4079166, 4013373, 4144959, 4144959, 4144960, 4079167, 4144703, 4144959, 4079166, 4144959, 4144959, 4144959, 4144959, 4079166, 4079166, 4013373, 4144959, 4013373, 4079167, 4013375, 4079167, 4079166, 4013373, 4079166, 4013373, 4079166, 4013373, 4079166, 4013373, 4079166, 4144959, 4079165, 4013372, 4079166, 4144959, 4013373, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4144959, 4013629, 4079166, 4079166, 4079166, 4013373, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4144959, 4079423, 4079423, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4079166, 4144959, 4079166, 4013629, 4079166, 4079166, 4079166, 4079167, 4013631, 4079167, 4013374, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4013629, 4079166, 4079166, 4079166, 4079164, 4013373, 4079166, 4079166, 4079166, 4079166, 4013373, 4079166, 4013373, 4079166, 4079166, 4079166, 4079166, 4013373, 4079166, 4079422, 4079166, 4013629, 4013373, 4144958, 4013374, 4079167, 4079167, 4013373, 4145215, 4144959, 4144959, 4144959, 4144959, 4079166, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4013374, 4079167, 4013375, 4079167, 4013375, 4079167, 4013375, 4079167, 4013374, 4079167, 4079167, 4013375, 4013374, 4013374, 4079166, 4013373, 4079166, 4144957, 4013373, 4079166, 4013373, 4079166, 4079166, 4079166, 4079166, 4079166, 4013373, 4079166, 4013373, 4013373, 4079166, 4079166, 4013373, 4079166, 4079166, 4079166, 4144959, 4079167, 4013375, 4013375, 4079166, 4079422, 4144959, 4144959, 4079166, 4144959, 4144959, 4144959, 4079166, 4144959, 4144959, 4144959, 4144959, 4144959, 4079167, 4079167, 4013374, 4079167, 4079167, 4079167, 4079167, 4079167, 4013374, 4079167, 4013375, 4079167, 4079167, 4079166, 4013373, 4079165, 4079165, 3947582, 4079166, 4079166, 4013373, 4079166, 4079166, 4013373, 4079166, 4144959, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4013373, 4144958, 4079166, 4079166, 4013373, 4079167, 4079166, 4013373, 4144959, 4144959, 4144959, 4079166, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4079166, 4144959, 4079166, 4144959, 4013375, 4079167, 4013375, 4013373, 4013375, 4079167, 4079167, 4013375, 4079167, 4079167, 4013375, 4079167, 4144959, 4079166, 3947582, 3947581, 4079166, 4013373, 4079166, 4079166, 4013373, 4079166, 4079166, 4079166, 4013373, 4079166, 4079166, 4079166, 4079166, 4013373, 4079166, 4079166, 4013373, 4079166, 4013373, 4079166, 4079166, 4079166, 4079166, 4079167, 4144959, 4144959, 4144959, 4144959, 4144959, 4144959, 4079166, 4144959, 4144959, 4079166, 4144959, 4144959, 4144959, 4144959, 4079167, 4079167, 4079167, 4079167, 4013375, 4013374, 4013375, 4079167, 4013374, 4079167, 4013374, 4013375, 4079166, 4013374, 4013374, 4079166, 4079166, 4144959, 4079166, 4079166, 4079166, 4013373, 4079166, 4079166, 4079166, 4013373, 4013373, 4079166, 4079167, 4079167, 4144959, 4079167, 4079167, 4079166, 4079166, 4013373, 4079166, 4013373, 4079423, 4079423, 4144959, 4144959, 4079166, 4144959, 4079167, 4013374, 4079167, 4079167, 4013375, 4144959, 4144959, 4079166, 4144959, 4013631, 4013374, 4079167, 4013374, 4144959, 4079167, 4079167, 4079167, 4079166, 4013373, 4079167, 4079167, 3947581, 3947582, 4013374, 4079166, 4079166, 4013629, 4013373, 4079166, 4079166, 4013373, 4079166, 4079166, 4079166, 4079166, 4144959, 4079166, 4013374, 4079167, 4013373, 4079166, 3947582, 4013374, 4079166, 4144959, 4079166, 4079166, 4145216, 4144959, 4144959, 4145216, 4144959, 4079166, 4144959, 4079167, 4013375, 4079167, 4079167, 4144959, 4144959, 4144959, 4079166, 4144959, 4013375, 4079167, 4079167, 4079167, 4013375, 4079166, 4013373, 4079166, 4079166, 4144959, 4079167, 4013374, 4079167, 4079167, 4013374, 4013373, 4079166, 4079166, 4013373, 4079166, 4144959, 4079166, 4013373, 4013373, 4079166, 4079166, 4013373, 4013375, 4079166, 4013374, 4013374, 4013374, 3947581, 4079166, 4079166, 4013373, 4079166, 4079423, 4144959, 4079423, 4144959, 4079422, 4144959, 4144959, 4144959, 4144959, 4013374, 4079167, 4144959, 4144959, 4144959, 4144959, 4144959, 4079167, 4013375, 4013375, 4079167, 4013373, 4079166, 4013629, 4079166, 4013373, 4013375, 4079167, 4079167, 4079167, 4013374, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4079166, 4013374, 4079166, 4013629, 4013374, 3947581, 3947582, 4079166, 4079166, 4013373, 4079166, 4079166, 789773, 855566, 855566, 789773, 921358, 855565, 855309, 855309, 789516, 855309, 855309, 789516, 789516, 921102, 855309, 789516, 855309, 723724, 789518, 789516, 723723, 789516, 789516, 789516, 789516, 723724, 789517, 723725, 789518, 723725, 789517, 789516, 723723, 789516, 789516, 723723, 789516, 723723, 723979, 723724, 789516, 657931, 789516, 723723, 789516, 657932, 723724, 657931, 855309, 789516, 789516, 789516, 723723, 724493, 724492, 724236, 724236, 724491, 723979, 657930, 723723, 723723, 657930, 723723, 723723, 723723, 723723, 657930, 723723, 658187, 592394, 658187, 657930, 657930, 723723, 592137, 657930, 657930, 658442, 592139, 658187, 592394, 658187, 592651, 658187, 592651, 658187, 592137, 592394, 592394, 592394, 592394, 526601, 526858, 723723, 657930, 592137, 526858, 592394, 526601, 592394, 526858, 592394, 592394, 592137, 657930, 724236, 658700, 658700, 724492, 658700, 724492, 724493, 723979, 789772, 723979, 723979, 724235, 723979, 723979, 724235, 723979, 658187, 658187, 658187, 658186, 658186, 592649, 658186, 658186, 658186, 592649, 592649, 658444, 658187, 658187, 658187, 658187, 592649, 658442, 723979, 526858, 526601, 526858, 526858, 658186, 592649, 658186, 658186, 658186, 658186, 592651, 526858, 592394, 592394, 526601, 526858, 592394, 592651, 724236, 658699, 724492, 658699, 724236, 724492, 658700, 724236, 658186, 723979, 723979, 723979, 658442, 723979, 658186, 789772, 723979, 592651, 592394, 658442, 592649, 658186, 658442, 592649, 658186, 658186, 658186, 723979, 592651, 592393, 592651, 592394, 658186, 658186, 526858, 526858, 592394, 592394, 592651, 658186, 592649, 658186, 658442, 658186, 592393, 592394, 592394, 526858, 526601, 592394, 592394, 526601, 526858, 724492, 724236, 724236, 724493, 658700, 724236, 658699, 724236, 724235, 724235, 658442, 724235, 723979, 723979, 724235, 723979, 658187, 592651, 789772, 658187, 592393, 658186, 658442, 658186, 658186, 658442, 658441, 658186, 592651, 658187, 658444, 592649, 658186, 658186, 592393, 592394, 592394, 526601, 592393, 526858, 658442, 658442, 592393, 592649, 592394, 526601, 526858, 592394, 592651, 526858, 592394, 526858, 592394, 724493, 658700, 724492, 724236, 724236, 658699, 724492, 724236, 723979, 658442, 723979, 723979, 789772, 723979, 723979, 658442, 658187, 592394, 723979, 658187, 658186, 592649, 658186, 658186, 592393, 526858, 592394, 658442, 658186, 658442, 658186, 658186, 658186, 592649, 658186, 592394, 526858, 592394, 658186, 592649, 658186, 658186, 658186, 658186, 592651, 592394, 526601, 526858, 592394, 526858, 526601, 592394, 526601];

        let img_bitmap: [ARGB; 1378] = unsafe { std::mem::transmute(img_raw_bitmap) };

        let score: f32 = img_bitmap.iter().map(|pixel| pixel_score(*pixel)).sum();

        println!("{score}");
    }
}
